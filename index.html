<!DOCTYPE html>
<html lang="en" class="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExpenseFlow Pro</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: { 750: '#2d3748', 850: '#1a202c', 900: '#0f172a' }
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore-compat.js"></script>

    <link rel="manifest" href="site.webmanifest">
    <link rel="stylesheet" href="style.css">
</head>

<body
    class="bg-gray-50 text-gray-800 dark:bg-slate-900 dark:text-gray-100 h-screen overflow-hidden transition-colors duration-300">

    <div id="toast-container"></div>

    <div id="view-lock"
        class="hidden fixed inset-0 z-[100] bg-slate-900 flex flex-col items-center justify-center text-white">
        <div class="mb-8 flex flex-col items-center">
            <div
                class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mb-4 shadow-lg shadow-blue-500/50">
                <i class="fa-solid fa-lock text-3xl"></i>
            </div>
            <h2 class="text-2xl font-bold">App Locked</h2>
            <p class="text-slate-400 text-sm mt-1">Enter your 4-digit PIN to unlock</p>
        </div>
        <div class="flex gap-4 mb-8">
            <div class="pin-dot" id="pin-1"></div>
            <div class="pin-dot" id="pin-2"></div>
            <div class="pin-dot" id="pin-3"></div>
            <div class="pin-dot" id="pin-4"></div>
        </div>
        <div class="grid grid-cols-3 gap-6 text-2xl font-medium">
            <button onclick="enterPin(1)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">1</button>
            <button onclick="enterPin(2)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">2</button>
            <button onclick="enterPin(3)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">3</button>
            <button onclick="enterPin(4)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">4</button>
            <button onclick="enterPin(5)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">5</button>
            <button onclick="enterPin(6)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">6</button>
            <button onclick="enterPin(7)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">7</button>
            <button onclick="enterPin(8)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">8</button>
            <button onclick="enterPin(9)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">9</button>
            <div class="w-16 h-16"></div>
            <button onclick="enterPin(0)" class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors">0</button>
            <button onclick="clearPin()"
                class="w-16 h-16 rounded-full hover:bg-slate-800 transition-colors text-rose-500"><i
                    class="fa-solid fa-delete-left"></i></button>
        </div>
    </div>

    <div id="view-landing"
        class="hidden w-full h-full flex flex-col items-center justify-center bg-white dark:bg-slate-900">
        <div class="text-center space-y-6 max-w-md px-6 fade-in">
            <div
                class="w-20 h-20 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto shadow-xl shadow-blue-200 dark:shadow-none">
                <i class="fa-solid fa-indian-rupee-sign text-white text-3xl"></i>
            </div>
            <div>
                <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">ExpenseFlow Pro</h1>
                <p class="text-gray-500 dark:text-gray-400">Track expenses, set budgets, and visualize your financial
                    health.</p>
            </div>
            <button onclick="signInWithGoogle()"
                class="w-full flex items-center justify-center gap-3 px-6 py-4 border border-gray-200 dark:border-slate-700 rounded-xl hover:bg-gray-50 dark:hover:bg-slate-800 transition-all group relative overflow-hidden bg-white dark:bg-slate-800">
                <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-6 h-6" alt="Google Logo">
                <span class="font-semibold text-gray-700 dark:text-gray-200">Sign in with Google</span>
            </button>
            <p class="text-xs text-gray-400 mt-8">Secure & Private • Powered by Firebase</p>
        </div>
    </div>

    <div id="app-layout" class="hidden flex h-full w-full">
        <div id="mobileOverlay" class="overlay" onclick="toggleSidebar()"></div>

        <aside id="sidebar"
            class="sidebar bg-slate-900 dark:bg-slate-950 text-white w-64 flex-shrink-0 flex flex-col h-full shadow-2xl border-r border-slate-800">
            <div class="p-6 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                        <i class="fa-solid fa-indian-rupee-sign text-white text-sm"></i>
                    </div>
                    <h1 class="text-xl font-bold tracking-tight">ExpenseFlow</h1>
                </div>
                <button class="md:hidden text-gray-400 hover:text-white" onclick="toggleSidebar()">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <nav class="flex-1 px-4 py-4 space-y-2 overflow-y-auto">
                <a href="#" onclick="showPage('dashboard')" id="nav-dashboard"
                    class="nav-item flex items-center gap-3 px-4 py-3 bg-blue-600 rounded-xl text-white transition-colors">
                    <i class="fa-solid fa-chart-pie w-5"></i> <span class="font-medium">Dashboard</span>
                </a>
                <a href="#" onclick="showPage('networth')" id="nav-networth"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-scale-balanced w-5"></i> <span class="font-medium">Net Worth</span>
                </a>
                <a href="#" onclick="showPage('transactions')" id="nav-transactions"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-list-ul w-5"></i> <span class="font-medium">Transactions</span>
                </a>
                <a href="#" onclick="showPage('family')" id="nav-family"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-users w-5"></i> <span class="font-medium">Family & Joint</span>
                </a>
                <a href="#" onclick="showPage('calendar')" id="nav-calendar"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-calendar-days w-5"></i> <span class="font-medium">Calendar</span>
                </a>
                <a href="#" onclick="showPage('shopping')" id="nav-shopping"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-cart-shopping w-5"></i> <span class="font-medium">Shopping List</span>
                </a>
                <a href="#" onclick="showPage('recurring')" id="nav-recurring"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-rotate w-5"></i> <span class="font-medium">Recurring</span>
                </a>
                <a href="#" onclick="showPage('debts')" id="nav-debts"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-hand-holding-dollar w-5"></i> <span class="font-medium">Debts</span>
                </a>
                <a href="#" onclick="showPage('tools')" id="nav-tools"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-screwdriver-wrench w-5"></i> <span class="font-medium">Tools</span>
                </a>
                <a href="#" onclick="showPage('goals')" id="nav-goals"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-bullseye w-5"></i> <span class="font-medium">Savings Goals</span>
                </a>
                <a href="#" onclick="showPage('settings')" id="nav-settings"
                    class="nav-item flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl transition-colors">
                    <i class="fa-solid fa-gear w-5"></i> <span class="font-medium">Settings</span>
                </a>
                <button id="installBtn"
                    class="hidden w-full flex items-center gap-3 px-4 py-3 text-emerald-400 hover:text-emerald-300 hover:bg-slate-800 rounded-xl transition-colors text-left mt-8">
                    <i class="fa-solid fa-download w-5"></i> <span class="font-medium">Install App</span>
                </button>
            </nav>

            <div class="p-4 border-t border-slate-800 space-y-3">
                <button onclick="toggleTheme()"
                    class="w-full flex items-center justify-between px-3 py-2 text-sm font-medium text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors">
                    <span class="flex items-center gap-2"><i class="fa-solid fa-moon"></i> Dark Mode</span>
                    <div class="w-8 h-4 bg-slate-700 rounded-full relative">
                        <div id="themeToggleDot" class="w-4 h-4 bg-white rounded-full absolute left-0 transition-all">
                        </div>
                    </div>
                </button>
                <div class="flex items-center gap-3 px-2 py-2">
                    <img id="userAvatar" src=""
                        class="w-10 h-10 rounded-full bg-slate-700 object-cover border-2 border-slate-700" alt="User">
                    <div class="overflow-hidden">
                        <p class="text-sm font-medium text-white truncate" id="userName">User</p>
                        <p class="text-xs text-slate-400 truncate" id="userEmail">Loading...</p>
                    </div>
                </div>
                <button onclick="logout()"
                    class="w-full flex items-center justify-center gap-2 py-2 text-xs font-medium text-rose-400 hover:text-rose-300 hover:bg-slate-800 rounded-lg transition-colors">
                    <i class="fa-solid fa-arrow-right-from-bracket"></i> Sign Out
                </button>
            </div>
        </aside>

        <main
            class="flex-1 flex flex-col h-full overflow-hidden bg-gray-50 dark:bg-slate-900 transition-colors duration-300 relative">
            <header
                class="bg-white dark:bg-slate-800 border-b border-gray-200 dark:border-slate-700 h-16 flex items-center justify-between px-6 flex-shrink-0 transition-colors">
                <button
                    class="md:hidden text-gray-600 dark:text-gray-300 p-2 -ml-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg"
                    onclick="toggleSidebar()">
                    <i class="fa-solid fa-bars text-xl"></i>
                </button>
                <h2 id="pageTitle" class="text-lg font-semibold text-gray-800 dark:text-white">Dashboard</h2>
                <div class="flex items-center gap-2">
                    <button onclick="openDebtModal()" id="addDebtBtn"
                        class="hidden bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center gap-2">
                        <i class="fa-solid fa-plus"></i> Debt Record
                    </button>
                    <button onclick="openGoalModal()" id="addGoalBtn"
                        class="hidden bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center gap-2">
                        <i class="fa-solid fa-plus"></i> New Goal
                    </button>
                    <button onclick="openRecurringModal()" id="addRecBtn"
                        class="hidden bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center gap-2">
                        <i class="fa-solid fa-plus"></i> Subscription
                    </button>
                    <button onclick="openFamilyModal()" id="addFamilyBtn"
                        class="hidden bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center gap-2">
                        <i class="fa-solid fa-user-plus"></i> Invite Member
                    </button>
                    <button onclick="openModal()" id="addTxnBtn"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center gap-2">
                        <i class="fa-solid fa-plus"></i> <span class="hidden sm:inline">Transaction</span>
                    </button>
                </div>
            </header>

            <div class="flex-1 overflow-y-auto p-4 md:p-8 relative" id="mainScroll">

                <div id="view-dashboard" class="space-y-6 max-w-7xl mx-auto pb-10">

                    <div
                        class="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-6 shadow-lg text-white relative overflow-hidden">
                        <div class="absolute right-0 bottom-0 p-4 opacity-10"><i
                                class="fa-solid fa-heart-pulse text-9xl"></i></div>
                        <div class="flex flex-col md:flex-row items-center justify-between gap-6 relative z-10">
                            <div>
                                <h3 class="text-xl font-bold flex items-center gap-2"><i
                                        class="fa-solid fa-heart-pulse text-rose-500"></i> Financial Health Score</h3>
                                <p class="text-slate-400 text-sm mt-1 max-w-md">Your score is calculated based on
                                    savings rate, budget adherence, and debt-to-income ratio.</p>
                                <div class="mt-4 flex gap-4 text-sm">
                                    <div>
                                        <p class="text-slate-500 uppercase text-[10px] font-bold tracking-wider">Status
                                        </p>
                                        <p class="font-bold text-emerald-400" id="healthStatus">Calculating...</p>
                                    </div>
                                    <div>
                                        <p class="text-slate-500 uppercase text-[10px] font-bold tracking-wider">Action
                                        </p>
                                        <p class="font-bold text-white" id="healthAction">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="relative w-24 h-24 flex items-center justify-center">
                                    <svg class="transform -rotate-90 w-24 h-24">
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8"
                                            fill="transparent" class="text-slate-700" />
                                        <circle id="healthCircle" cx="48" cy="48" r="40" stroke="currentColor"
                                            stroke-width="8" fill="transparent"
                                            class="text-emerald-500 transition-all duration-1000 ease-out"
                                            stroke-dasharray="251.2" stroke-dashoffset="251.2" />
                                    </svg>
                                    <span class="absolute text-2xl font-bold" id="healthScore">0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div
                            class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 flex flex-col justify-between">
                            <div class="flex justify-between items-end mb-2">
                                <div>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 font-medium">Monthly Budget</p>
                                    <h3 class="text-2xl font-bold text-gray-800 dark:text-white"><span
                                            id="spentThisMonth">₹0</span> <span
                                            class="text-sm font-normal text-gray-400">/ <span
                                                id="budgetDisplay">₹0</span></span></h3>
                                </div>
                                <button onclick="openBudgetModal()"
                                    class="text-blue-600 dark:text-blue-400 text-sm font-medium hover:bg-blue-50 dark:hover:bg-slate-700 px-3 py-1 rounded-lg transition-colors">Edit</button>
                            </div>
                            <div class="w-full bg-gray-100 dark:bg-slate-700 rounded-full h-3">
                                <div id="budgetProgressBar"
                                    class="bg-emerald-500 h-3 rounded-full transition-all duration-500"
                                    style="width: 0%"></div>
                            </div>
                            <p id="budgetMessage" class="text-xs text-gray-400 mt-2">Set a budget to track progress.</p>
                        </div>
                        <div
                            class="bg-gradient-to-br from-indigo-600 to-purple-700 p-6 rounded-2xl shadow-lg text-white relative overflow-hidden">
                            <div class="absolute right-0 top-0 p-4 opacity-10"><i
                                    class="fa-solid fa-brain text-8xl"></i></div>
                            <h3 class="text-sm font-medium text-indigo-100 mb-4 flex items-center gap-2"><i
                                    class="fa-solid fa-wand-magic-sparkles"></i> Smart Insights</h3>
                            <div class="grid grid-cols-3 gap-2">
                                <div>
                                    <p class="text-[10px] text-indigo-200 uppercase tracking-wide">Top Category</p>
                                    <p class="text-sm font-bold truncate" id="insightTopCat">-</p>
                                    <p class="text-[10px] text-indigo-200" id="insightTopCatAmount">₹0</p>
                                </div>
                                <div>
                                    <p class="text-[10px] text-indigo-200 uppercase tracking-wide">Projected</p>
                                    <p class="text-sm font-bold" id="insightProjection">₹0</p>
                                    <p class="text-[10px] text-indigo-200">End of Month</p>
                                </div>
                                <div>
                                    <p class="text-[10px] text-indigo-200 uppercase tracking-wide">Daily Avg</p>
                                    <p class="text-sm font-bold" id="insightDailyAvg">₹0</p>
                                    <p class="text-[10px] text-indigo-200">Last 30 Days</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="categoryBudgetsSection"
                        class="hidden bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700">
                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">Category Budgets</h3>
                        <div id="categoryBudgetsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div
                            class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 relative overflow-hidden">
                            <div class="absolute right-0 top-0 p-6 opacity-10"><i
                                    class="fa-solid fa-scale-balanced text-6xl text-blue-600 dark:text-blue-400"></i>
                            </div>
                            <p class="text-sm text-gray-500 dark:text-gray-400 font-medium mb-1">Total Balance</p>
                            <h3 class="text-2xl font-bold text-gray-800 dark:text-white" id="totalBalance">₹0.00</h3>
                        </div>
                        <div
                            class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 relative overflow-hidden">
                            <div class="absolute right-0 top-0 p-6 opacity-10"><i
                                    class="fa-solid fa-arrow-trend-up text-6xl text-emerald-500"></i></div>
                            <p class="text-sm text-gray-500 dark:text-gray-400 font-medium mb-1">Total Income</p>
                            <h3 class="text-2xl font-bold text-emerald-600" id="totalIncome">₹0.00</h3>
                        </div>
                        <div
                            class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 relative overflow-hidden">
                            <div class="absolute right-0 top-0 p-6 opacity-10"><i
                                    class="fa-solid fa-arrow-trend-down text-6xl text-rose-500"></i></div>
                            <p class="text-sm text-gray-500 dark:text-gray-400 font-medium mb-1">Total Expenses</p>
                            <h3 class="text-2xl font-bold text-rose-600" id="totalExpense">₹0.00</h3>
                        </div>
                        <div
                            class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 relative overflow-hidden">
                            <div class="absolute right-0 top-0 p-6 opacity-10"><i
                                    class="fa-solid fa-piggy-bank text-6xl text-purple-500"></i></div>
                            <p class="text-sm text-gray-500 dark:text-gray-400 font-medium mb-1">Total Invested</p>
                            <h3 class="text-2xl font-bold text-purple-600 dark:text-purple-400" id="totalInvestment">
                                ₹0.00</h3>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-1 space-y-6">
                            <div
                                class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 flex flex-col items-center justify-center">
                                <h3 class="text-lg font-bold text-gray-800 dark:text-white w-full mb-4">By Category</h3>
                                <div class="relative w-full max-w-[280px]"><canvas id="expenseChart"></canvas></div>
                                <div id="chartLegend" class="w-full mt-6 space-y-2 text-sm"></div>
                            </div>
                        </div>
                        <div class="lg:col-span-2 space-y-6">
                            <div
                                class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700">
                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">Monthly Comparison</h3>
                                <div class="w-full h-64"><canvas id="comparisonChart"></canvas></div>
                            </div>
                            <div
                                class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700">
                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">Spending Trend (Last 7
                                    Days)</h3>
                                <div class="w-full h-64"><canvas id="trendChart"></canvas></div>
                            </div>
                            <div
                                class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 flex flex-col">
                                <div class="flex items-center justify-between mb-6">
                                    <h3 class="text-lg font-bold text-gray-800 dark:text-white">Recent Transactions</h3>
                                    <button onclick="showPage('transactions')"
                                        class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 font-medium">View
                                        All</button>
                                </div>
                                <div class="overflow-y-auto pr-2" style="max-height: 400px;">
                                    <div id="recentList" class="space-y-3">
                                        <div class="text-center py-10 text-gray-400">
                                            <div class="loader mx-auto mb-3"></div>
                                            <p>Loading data...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="view-family" class="hidden max-w-7xl mx-auto space-y-8 pb-10">
                    <div
                        class="bg-gradient-to-r from-indigo-600 to-purple-700 rounded-3xl p-8 text-white relative overflow-hidden shadow-lg">
                        <div class="absolute right-0 top-0 p-8 opacity-10"><i class="fa-solid fa-users text-9xl"></i>
                        </div>
                        <h2 class="text-3xl font-bold mb-2">Family & Joint Banking</h2>
                        <p class="text-indigo-100 max-w-xl">Manage shared expenses, joint accounts, and family
                            allowances all in one place. Collaborate on your financial goals together.</p>
                        <div class="mt-6 flex gap-3">
                            <button onclick="openFamilyModal()"
                                class="px-5 py-2.5 bg-white text-indigo-700 rounded-xl font-bold text-sm hover:bg-indigo-50 transition-colors">Invite
                                Member</button>
                            <button onclick="createJointAccount()"
                                class="px-5 py-2.5 bg-indigo-500/30 border border-white/30 text-white rounded-xl font-bold text-sm hover:bg-indigo-500/50 transition-colors">Add
                                Joint Account</button>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2"><i
                                class="fa-solid fa-wallet text-indigo-500"></i> Joint Accounts</h3>
                        <div id="jointAccountsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        </div>
                        <div id="emptyJoint"
                            class="hidden py-8 text-center bg-white dark:bg-slate-800 rounded-2xl border border-dashed border-gray-300 dark:border-slate-700">
                            <p class="text-gray-400">No joint accounts yet.</p>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2"><i
                                class="fa-solid fa-user-group text-pink-500"></i> Family Members</h3>
                        <div id="familyMembersGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        </div>
                        <div id="emptyFamily"
                            class="hidden py-8 text-center bg-white dark:bg-slate-800 rounded-2xl border border-dashed border-gray-300 dark:border-slate-700">
                            <p class="text-gray-400">No family members added.</p>
                        </div>
                    </div>
                </div>

                <div id="view-networth" class="hidden max-w-7xl mx-auto pb-10">
                    <div
                        class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl shadow-xl p-8 text-white mb-8 relative overflow-hidden">
                        <div class="absolute right-0 top-0 p-8 opacity-10"><i
                                class="fa-solid fa-scale-balanced text-9xl"></i></div>
                        <p class="text-sm font-medium text-slate-400 uppercase tracking-wide mb-1">Total Net Worth</p>
                        <h2 class="text-5xl font-bold mb-6" id="nwTotal">₹0.00</h2>

                        <div class="grid grid-cols-2 gap-6 pt-6 border-t border-slate-700/50">
                            <div>
                                <p class="text-sm text-emerald-400 mb-1"><i class="fa-solid fa-arrow-trend-up"></i>
                                    Total Assets</p>
                                <p class="text-2xl font-bold" id="nwAssets">₹0.00</p>
                            </div>
                            <div>
                                <p class="text-sm text-rose-400 mb-1"><i class="fa-solid fa-arrow-trend-down"></i> Total
                                    Liabilities</p>
                                <p class="text-2xl font-bold" id="nwLiabilities">₹0.00</p>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4">Breakdown</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div
                            class="bg-white dark:bg-slate-800 p-5 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700">
                            <div class="flex justify-between items-start mb-3">
                                <div
                                    class="w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 flex items-center justify-center">
                                    <i class="fa-solid fa-wallet"></i>
                                </div>
                                <span
                                    class="text-xs font-bold bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-2 py-1 rounded">Asset</span>
                            </div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Cash Balance</p>
                            <h4 class="text-xl font-bold text-gray-800 dark:text-white" id="nwCash">₹0.00</h4>
                        </div>
                        <div
                            class="bg-white dark:bg-slate-800 p-5 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700">
                            <div class="flex justify-between items-start mb-3">
                                <div
                                    class="w-10 h-10 rounded-lg bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 flex items-center justify-center">
                                    <i class="fa-solid fa-chart-line"></i>
                                </div>
                                <span
                                    class="text-xs font-bold bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-2 py-1 rounded">Asset</span>
                            </div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Investments</p>
                            <h4 class="text-xl font-bold text-gray-800 dark:text-white" id="nwInvest">₹0.00</h4>
                        </div>
                        <div
                            class="bg-white dark:bg-slate-800 p-5 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700">
                            <div class="flex justify-between items-start mb-3">
                                <div
                                    class="w-10 h-10 rounded-lg bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 flex items-center justify-center">
                                    <i class="fa-solid fa-bullseye"></i>
                                </div>
                                <span
                                    class="text-xs font-bold bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-2 py-1 rounded">Asset</span>
                            </div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Savings Goals</p>
                            <h4 class="text-xl font-bold text-gray-800 dark:text-white" id="nwSavings">₹0.00</h4>
                        </div>
                        <div
                            class="bg-white dark:bg-slate-800 p-5 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700">
                            <div class="flex justify-between items-start mb-3">
                                <div
                                    class="w-10 h-10 rounded-lg bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 flex items-center justify-center">
                                    <i class="fa-solid fa-hand-holding-dollar"></i>
                                </div>
                                <span
                                    class="text-xs font-bold bg-rose-100 dark:bg-rose-900/30 text-rose-600 dark:text-rose-400 px-2 py-1 rounded">Liability</span>
                            </div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Debt Outstanding</p>
                            <h4 class="text-xl font-bold text-gray-800 dark:text-white" id="nwDebt">₹0.00</h4>
                        </div>
                    </div>
                </div>

                <div id="view-shopping" class="hidden max-w-4xl mx-auto pb-10">
                    <div
                        class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 overflow-hidden">
                        <div
                            class="p-6 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-white"><i
                                    class="fa-solid fa-cart-shopping mr-2"></i> Shopping List</h3>
                            <button onclick="checkoutShoppingList()"
                                class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors">
                                Checkout Selected (<span id="shoppingTotal">₹0</span>)
                            </button>
                        </div>
                        <div class="p-6 bg-gray-50 dark:bg-slate-800/50 border-b border-gray-100 dark:border-slate-700">
                            <form id="shoppingForm" class="flex gap-2">
                                <input type="text" id="shopItem" placeholder="Item name (e.g., Milk)"
                                    class="flex-1 px-4 py-2 bg-white dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                                    required>
                                <div class="relative w-32">
                                    <span
                                        class="currency-symbol absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold text-xs">₹</span>
                                    <input type="number" step="0.01" id="shopCost" placeholder="Est. Cost"
                                        class="w-full pl-7 pr-4 py-2 bg-white dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none">
                                </div>
                                <button type="submit"
                                    class="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl"><i
                                        class="fa-solid fa-plus"></i></button>
                            </form>
                        </div>
                        <div id="shoppingList" class="divide-y divide-gray-100 dark:divide-slate-700">
                        </div>
                        <div id="emptyShopping" class="hidden py-12 text-center text-gray-400">
                            <p>List is empty.</p>
                        </div>
                    </div>
                </div>

                <div id="view-transactions" class="hidden max-w-6xl mx-auto pb-10">
                    <div
                        class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 overflow-hidden">
                        <div
                            class="p-6 border-b border-gray-100 dark:border-slate-700 flex flex-col md:flex-row gap-4 justify-between items-center bg-gray-50 dark:bg-slate-800">
                            <div class="flex flex-col gap-3 w-full md:w-auto flex-1">
                                <div class="flex flex-col sm:flex-row gap-2">
                                    <div class="relative flex-1 sm:w-64">
                                        <i
                                            class="fa-solid fa-search absolute left-3 top-3 text-gray-400 dark:text-gray-500 text-sm"></i>
                                        <input type="text" id="searchInput" placeholder="Search..."
                                            class="w-full pl-9 pr-4 py-2 bg-white dark:bg-slate-700 dark:text-white border border-gray-200 dark:border-slate-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                                    </div>
                                    <div class="flex gap-2">
                                        <select id="filterType"
                                            class="px-3 py-2 bg-white dark:bg-slate-700 dark:text-white border border-gray-200 dark:border-slate-600 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="all">All Types</option>
                                            <option value="income">Income</option>
                                            <option value="expense">Expense</option>
                                            <option value="investment">Investment</option>
                                        </select>
                                        <select id="filterWallet"
                                            class="px-3 py-2 bg-white dark:bg-slate-700 dark:text-white border border-gray-200 dark:border-slate-600 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="all">All Wallets</option>
                                        </select>
                                        <select id="filterTag"
                                            class="px-3 py-2 bg-white dark:bg-slate-700 dark:text-white border border-gray-200 dark:border-slate-600 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="all">All Tags</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="flex flex-col sm:flex-row gap-2 items-center">
                                    <select id="filterDate" onchange="toggleCustomDate()"
                                        class="px-3 py-2 bg-white dark:bg-slate-700 dark:text-white border border-gray-200 dark:border-slate-600 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-auto">
                                        <option value="all">All Time</option>
                                        <option value="this_month">This Month</option>
                                        <option value="last_month">Last Month</option>
                                        <option value="this_year">This Year</option>
                                        <option value="custom">Custom Range</option>
                                    </select>
                                    <div id="customDateRange" class="hidden flex gap-2">
                                        <input type="date" id="startDate"
                                            class="px-3 py-2 bg-white dark:bg-slate-700 dark:text-white border border-gray-200 dark:border-slate-600 rounded-xl text-sm outline-none">
                                        <input type="date" id="endDate"
                                            class="px-3 py-2 bg-white dark:bg-slate-700 dark:text-white border border-gray-200 dark:border-slate-600 rounded-xl text-sm outline-none">
                                    </div>
                                </div>
                            </div>
                            <div class="flex gap-2 mt-3 md:mt-0">
                                <button onclick="exportCSV()"
                                    class="text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white text-sm font-medium flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
                                    <i class="fa-solid fa-file-csv text-green-600 text-lg"></i> CSV
                                </button>
                                <button onclick="exportPDF()"
                                    class="text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white text-sm font-medium flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors">
                                    <i class="fa-solid fa-file-pdf text-rose-600 text-lg"></i> PDF
                                </button>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-collapse">
                                <thead>
                                    <tr
                                        class="bg-gray-50 dark:bg-slate-700 text-xs uppercase text-gray-500 dark:text-gray-300 font-semibold border-b border-gray-100 dark:border-slate-600">
                                        <th class="px-6 py-4 rounded-tl-lg">Category</th>
                                        <th class="px-6 py-4">Date</th>
                                        <th class="px-6 py-4">Wallet</th>
                                        <th class="px-6 py-4">Note</th>
                                        <th class="px-6 py-4 text-right">Amount</th>
                                        <th class="px-6 py-4 rounded-tr-lg text-center">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="fullTransactionList"
                                    class="text-sm divide-y divide-gray-100 dark:divide-slate-700"></tbody>
                            </table>
                        </div>
                        <div id="emptyState"
                            class="hidden py-12 flex flex-col items-center justify-center text-gray-400">
                            <div
                                class="w-16 h-16 bg-gray-100 dark:bg-slate-700 rounded-full flex items-center justify-center mb-4">
                                <i class="fa-solid fa-receipt text-2xl text-gray-300"></i>
                            </div>
                            <p>No transactions found.</p>
                        </div>
                    </div>
                </div>

                <div id="view-calendar" class="hidden max-w-7xl mx-auto pb-10">
                    <div
                        class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 overflow-hidden p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-white" id="calendarTitle">Calendar</h3>
                            <div class="flex gap-2">
                                <button onclick="changeMonth(-1)"
                                    class="p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg"><i
                                        class="fa-solid fa-chevron-left"></i></button>
                                <button onclick="changeMonth(1)"
                                    class="p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg"><i
                                        class="fa-solid fa-chevron-right"></i></button>
                            </div>
                        </div>
                        <div
                            class="calendar-grid mb-2 text-center font-medium text-gray-500 dark:text-gray-400 text-sm">
                            <div>Sun</div>
                            <div>Mon</div>
                            <div>Tue</div>
                            <div>Wed</div>
                            <div>Thu</div>
                            <div>Fri</div>
                            <div>Sat</div>
                        </div>
                        <div id="calendarGrid" class="calendar-grid text-sm"></div>
                    </div>
                </div>

                <div id="view-recurring" class="hidden max-w-7xl mx-auto pb-10">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="recurringGrid"></div>
                    <div id="emptyRecurring"
                        class="hidden flex flex-col items-center justify-center py-12 text-gray-400">
                        <i class="fa-solid fa-rotate text-4xl mb-4 text-gray-300 dark:text-slate-600"></i>
                        <p class="text-lg font-medium mb-2">No subscriptions yet</p>
                        <button onclick="openRecurringModal()" class="text-blue-500 hover:text-blue-600 font-medium">Add
                            Subscription</button>
                    </div>
                </div>

                <div id="view-goals" class="hidden max-w-7xl mx-auto pb-10">
                    <div id="goalsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                    <div id="emptyGoals" class="hidden flex flex-col items-center justify-center py-12 text-gray-400">
                        <div
                            class="w-20 h-20 bg-gray-100 dark:bg-slate-800 rounded-full flex items-center justify-center mb-4">
                            <i class="fa-solid fa-bullseye text-4xl text-gray-300 dark:text-slate-600"></i>
                        </div>
                        <p class="text-lg font-medium mb-2">No goals set yet</p>
                        <button onclick="openGoalModal()" class="text-blue-500 hover:text-blue-600 font-medium">Create
                            your first goal</button>
                    </div>
                </div>

                <div id="view-debts" class="hidden max-w-7xl mx-auto pb-10">
                    <div id="debtsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
                    <div id="emptyDebts" class="hidden flex flex-col items-center justify-center py-12 text-gray-400">
                        <div
                            class="w-20 h-20 bg-gray-100 dark:bg-slate-800 rounded-full flex items-center justify-center mb-4">
                            <i class="fa-solid fa-hand-holding-dollar text-4xl text-gray-300 dark:text-slate-600"></i>
                        </div>
                        <p class="text-lg font-medium mb-2">No debts recorded</p>
                        <button onclick="openDebtModal()" class="text-blue-500 hover:text-blue-600 font-medium">Add Debt
                            Record</button>
                    </div>
                </div>

                <div id="view-tools" class="hidden max-w-3xl mx-auto pb-10">
                    <div
                        class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 overflow-hidden">
                        <div class="p-6 border-b border-gray-100 dark:border-slate-700">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2">
                                <i class="fa-solid fa-utensils"></i> Split Bill Calculator
                            </h3>
                        </div>
                        <div class="p-6 space-y-4">
                            <div class="grid grid-cols-3 gap-4">
                                <div>
                                    <label
                                        class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Total
                                        Bill</label>
                                    <input type="number" id="splitTotal"
                                        class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                                        placeholder="0.00">
                                </div>
                                <div>
                                    <label
                                        class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">People</label>
                                    <input type="number" id="splitPeople" value="2"
                                        class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none">
                                </div>
                                <div>
                                    <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Tip
                                        %</label>
                                    <input type="number" id="splitTip" value="0"
                                        class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none">
                                </div>
                            </div>
                            <button onclick="calculateSplit()"
                                class="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold shadow-lg">Calculate</button>

                            <div id="splitResult"
                                class="hidden mt-6 p-4 bg-indigo-50 dark:bg-indigo-900/30 rounded-xl border border-indigo-100 dark:border-indigo-800 text-center">
                                <p class="text-sm text-indigo-500 dark:text-indigo-300 uppercase font-bold mb-1">Per
                                    Person</p>
                                <h3 class="text-3xl font-bold text-indigo-700 dark:text-indigo-200 mb-4"
                                    id="splitPerPerson">₹0.00</h3>
                                <button onclick="logSplitShare()"
                                    class="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium">Log
                                    My Share</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="view-settings" class="hidden max-w-3xl mx-auto space-y-6 pb-10">
                    <div
                        class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 overflow-hidden">
                        <div class="p-6 border-b border-gray-100 dark:border-slate-700">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-white">General Preferences</h3>
                        </div>
                        <div class="p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-bold text-gray-800 dark:text-white">Currency Symbol</h4>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Select your preferred currency
                                        display.</p>
                                </div>
                                <select id="currencySelect" onchange="saveCurrency()"
                                    class="px-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white">
                                    <option value="INR">₹ (INR)</option>
                                    <option value="USD">$ (USD)</option>
                                    <option value="EUR">€ (EUR)</option>
                                    <option value="GBP">£ (GBP)</option>
                                    <option value="JPY">¥ (JPY)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div
                        class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 overflow-hidden">
                        <div class="p-6 border-b border-gray-100 dark:border-slate-700">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-white">Data Management</h3>
                        </div>
                        <div class="p-6">
                            <div class="flex flex-col sm:flex-row gap-4">
                                <button onclick="exportDataJSON()"
                                    class="flex items-center justify-center gap-2 px-4 py-3 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-xl hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors text-sm font-medium flex-1">
                                    <i class="fa-solid fa-download"></i> Backup Data (JSON)
                                </button>
                                <label
                                    class="flex items-center justify-center gap-2 px-4 py-3 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-xl hover:bg-emerald-200 dark:hover:bg-emerald-900/50 transition-colors text-sm font-medium cursor-pointer flex-1">
                                    <i class="fa-solid fa-upload"></i> Restore Data
                                    <input type="file" id="importFile" accept=".json" class="hidden"
                                        onchange="importDataJSON(this)">
                                </label>
                            </div>
                            <p class="text-xs text-gray-400 mt-3 text-center">Restoring data will merge new entries with
                                your existing data.</p>
                        </div>
                    </div>

                    <div
                        class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-gray-100 dark:border-slate-700 overflow-hidden">
                        <div class="p-6 border-b border-gray-100 dark:border-slate-700">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-white">Security</h3>
                        </div>
                        <div class="p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-bold text-gray-800 dark:text-white">App Lock</h4>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Require a 4-digit PIN to access
                                        the app.</p>
                                </div>
                                <button onclick="togglePinSetup()" id="pinToggleBtn"
                                    class="bg-gray-200 dark:bg-slate-700 relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none">
                                    <span id="pinToggleDot"
                                        class="translate-x-0 pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"></span>
                                </button>
                            </div>

                            <div id="pinSetupArea"
                                class="hidden mt-6 pt-6 border-t border-gray-100 dark:border-slate-700">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Set
                                    4-Digit PIN</label>
                                <div class="flex gap-2">
                                    <input type="password" id="settingPin" maxlength="4"
                                        class="w-32 px-4 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none text-center tracking-widest"
                                        placeholder="****">
                                    <button onclick="savePin()"
                                        class="px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 text-sm font-medium">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <footer
                class="bg-white dark:bg-slate-900 border-t border-gray-200 dark:border-slate-800 py-4 text-center shrink-0">
                <p class="text-sm text-gray-500 dark:text-gray-400">Designed by <span
                        class="font-semibold text-indigo-600 dark:text-indigo-400">Parul Gangwal</span></p>
            </footer>
        </main>
    </div>

    <div id="transactionModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl">
                <div class="p-6 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white" id="modalTitle">Add Transaction</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"><i
                            class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <form id="transactionForm" class="p-6 space-y-4">
                    <input type="hidden" id="editId">
                    <div class="grid grid-cols-3 gap-2 bg-gray-100 dark:bg-slate-700 p-1 rounded-xl">
                        <button type="button" onclick="setType('expense')" id="btn-expense"
                            class="py-2 rounded-lg text-sm font-medium transition-all shadow-sm bg-white dark:bg-slate-600 text-rose-600 dark:text-rose-400">Expense</button>
                        <button type="button" onclick="setType('income')" id="btn-income"
                            class="py-2 rounded-lg text-sm font-medium transition-all text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">Income</button>
                        <button type="button" onclick="setType('investment')" id="btn-investment"
                            class="py-2 rounded-lg text-sm font-medium transition-all text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">SIP/Inv.</button>
                    </div>
                    <input type="hidden" id="type" value="expense">

                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Wallet</label>
                        <select id="txnWallet"
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none appearance-none cursor-pointer"></select>
                    </div>

                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Amount</label>
                        <div class="relative">
                            <span
                                class="currency-symbol absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold">₹</span>
                            <input type="number" step="0.01" id="amount" required
                                class="w-full pl-8 pr-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl text-lg font-mono dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                                placeholder="0.00">
                        </div>
                    </div>
                    <div>
                        <label
                            class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Category</label>
                        <div class="flex gap-2">
                            <select id="category"
                                class="flex-1 px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none appearance-none cursor-pointer"></select>
                            <button type="button" onclick="openCategoryModal()"
                                class="px-4 py-2 bg-gray-100 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl hover:bg-gray-200 dark:hover:bg-slate-600 text-gray-600 dark:text-gray-300 transition-colors">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Date</label>
                        <input type="date" id="date" required
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl text-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Note
                            (Optional)</label>
                        <div class="relative">
                            <input type="text" id="note"
                                class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                                placeholder="What was this for?">
                            <button type="button" onclick="startVoiceInput('note')"
                                class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-blue-500">
                                <i class="fa-solid fa-microphone"></i>
                            </button>
                        </div>
                    </div>
                    <button type="submit"
                        class="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold shadow-lg shadow-blue-200 dark:shadow-none">Save
                        Transaction</button>
                </form>
            </div>
        </div>
    </div>

    <div id="recurringModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeRecurringModal()">
        </div>
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl">
                <div class="p-6 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white" id="recModalTitle">Add Subscription</h3>
                    <button onclick="closeRecurringModal()"
                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"><i
                            class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <form id="recurringForm" class="p-6 space-y-4">
                    <input type="hidden" id="recId">
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Name</label>
                        <input type="text" id="recName" required
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                            placeholder="e.g. Netflix">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label
                                class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Amount</label>
                            <input type="number" step="0.01" id="recAmount" required
                                class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white"
                                placeholder="0.00">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Due Day
                                (1-31)</label>
                            <input type="number" min="1" max="31" id="recDay" required
                                class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white">
                        </div>
                    </div>
                    <div>
                        <label
                            class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Category</label>
                        <select id="recCategory"
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white"></select>
                    </div>
                    <button type="submit"
                        class="w-full py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-xl font-bold shadow-lg">Save
                        Subscription</button>
                </form>
            </div>
        </div>
    </div>

    <div id="categoryModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeCategoryModal()">
        </div>
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm p-4">
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl">
                <div class="p-6 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white">Category Details</h3>
                    <button onclick="closeCategoryModal()"
                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"><i
                            class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <form id="categoryForm" class="p-6 space-y-4">
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Category
                            Name</label>
                        <input type="text" id="catName" required
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                            placeholder="e.g. Groceries">
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Parent Category
                            (Optional)</label>
                        <select id="catParent"
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none appearance-none cursor-pointer">
                            <option value="">None (Top Level)</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label
                                class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Color</label>
                            <input type="color" id="catColor"
                                class="w-full h-12 rounded-xl cursor-pointer bg-transparent" value="#3b82f6">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Icon
                                Class</label>
                            <input type="text" id="catIcon"
                                class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white text-sm"
                                placeholder="fa-tag" value="fa-tag">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Monthly Limit
                            (Optional)</label>
                        <div class="relative">
                            <span
                                class="currency-symbol absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold">₹</span>
                            <input type="number" id="catBudget"
                                class="w-full pl-8 pr-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                                placeholder="0.00">
                        </div>
                    </div>
                    <button type="submit"
                        class="w-full py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold shadow-lg">Save
                        Category</button>
                </form>
            </div>
        </div>
    </div>

    <div id="budgetModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeBudgetModal()"></div>
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm p-4">
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-6">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4">Set Monthly Budget</h3>
                <div class="relative mb-6">
                    <span
                        class="currency-symbol absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold">₹</span>
                    <input type="number" id="budgetInput"
                        class="w-full pl-8 pr-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl text-lg font-mono dark:text-white outline-none"
                        placeholder="e.g. 50000">
                </div>
                <div class="flex gap-3">
                    <button onclick="closeBudgetModal()"
                        class="flex-1 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-xl">Cancel</button>
                    <button onclick="saveBudget()"
                        class="flex-1 py-2 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700">Save</button>
                </div>
            </div>
        </div>
    </div>

    <div id="goalModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeGoalModal()"></div>
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl">
                <div class="p-6 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white" id="goalModalTitle">Add Goal</h3>
                    <button onclick="closeGoalModal()"
                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"><i
                            class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <form id="goalForm" class="p-6 space-y-4">
                    <input type="hidden" id="goalId">
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Goal
                            Name</label>
                        <input type="text" id="goalName" required
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                            placeholder="e.g. New Laptop">
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Target
                            Amount</label>
                        <div class="relative">
                            <span
                                class="currency-symbol absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold">₹</span>
                            <input type="number" step="0.01" id="goalTarget" required
                                class="w-full pl-8 pr-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl text-lg font-mono dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                                placeholder="0.00">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Saved
                            Amount</label>
                        <div class="relative">
                            <span
                                class="currency-symbol absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold">₹</span>
                            <input type="number" step="0.01" id="goalSaved" required
                                class="w-full pl-8 pr-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl text-lg font-mono dark:text-white focus:ring-2 focus:ring-blue-500 outline-none"
                                placeholder="0.00">
                        </div>
                    </div>
                    <button type="submit"
                        class="w-full py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold shadow-lg">Save
                        Goal</button>
                </form>
            </div>
        </div>
    </div>

    <div id="debtModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeDebtModal()"></div>
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl">
                <div class="p-6 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white" id="debtModalTitle">Add Debt Record</h3>
                    <button onclick="closeDebtModal()"
                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"><i
                            class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <form id="debtForm" class="p-6 space-y-4">
                    <input type="hidden" id="debtId">
                    <div class="grid grid-cols-2 gap-2 bg-gray-100 dark:bg-slate-700 p-1 rounded-xl">
                        <button type="button" onclick="setDebtType('lent')" id="btn-lent"
                            class="py-2 rounded-lg text-sm font-medium transition-all shadow-sm bg-white dark:bg-slate-600 text-emerald-600 dark:text-emerald-400">I
                            Lent</button>
                        <button type="button" onclick="setDebtType('borrowed')" id="btn-borrowed"
                            class="py-2 rounded-lg text-sm font-medium transition-all text-gray-500 dark:text-gray-400 hover:text-gray-700">I
                            Borrowed</button>
                    </div>
                    <input type="hidden" id="debtType" value="lent">
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Person
                            Name</label>
                        <input type="text" id="debtPerson" required
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl dark:text-white focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Amount</label>
                        <div class="relative">
                            <span
                                class="currency-symbol absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold">₹</span>
                            <input type="number" step="0.01" id="debtAmount" required
                                class="w-full pl-8 pr-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl text-lg font-mono dark:text-white outline-none">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1">Due Date
                            (Optional)</label>
                        <input type="date" id="debtDate"
                            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl text-gray-600 dark:text-white outline-none">
                    </div>
                    <button type="submit"
                        class="w-full py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-xl font-bold shadow-lg">Save
                        Record</button>
                </form>
            </div>
        </div>
    </div>

    <div id="familyModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeFamilyModal()">
        </div>
        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl">
                <div class="p-6 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800 dark:text-white">Invite Family Member</h3>
                    <button onclick="closeFamilyModal()"
                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"><i
                            class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <form id="inviteForm">
        <input type="hidden" name="_subject" value="New Family Account Invitation">
        <input type="hidden" name="_template" value="table">
        <input type="hidden" name="_captcha" value="false">
        
        <div class="form-group">
            <label for="inviteEmail">Family Member Email</label>
            <input type="email" id="inviteEmail" name="email" placeholder="spouse@example.com" required>
        </div>

        <div class="form-group">
            <label for="role">Role</label>
            <select name="role" id="role">
                <option value="JOINT_OWNER">Joint Owner</option>
                <option value="VIEWER">Viewer (Read Only)</option>
            </select>
        </div>

        <button type="submit" id="submitBtn">Send Invite</button>
    </form>
    
    <div id="formStatus"></div>
            </div>
        </div>
    </div>

   <script>
    document.addEventListener("DOMContentLoaded", function() {
    // 1. Get the element
    const form = document.getElementById('inviteForm');
    const statusDiv = document.getElementById('formStatus');

    // 2. SAFETY CHECK: Only run if the form actually exists on this page
    if (form) { 
        
        form.addEventListener('submit', function(e) {
            e.preventDefault(); 

            const formData = new FormData(form);
            const inviteeEmail = document.getElementById('inviteEmail').value;

            // --- Your Config & Link Logic ---
            formData.append("_cc", inviteeEmail); 
            formData.append("_autoresponse", "You have been invited to join the family account!");

            const link = `http://localhost:3000/accept-invite.html?inviter=${encodeURIComponent("JivaSteps@gmail.com")}`;
            formData.append("message", `You have been invited to a Joint Account. Click here to join: ${link}`);

            // --- UI Updates ---
            const btn = document.getElementById('submitBtn');
            btn.innerHTML = "Sending...";
            btn.disabled = true;

            // --- Fetch Call ---
            fetch("https://formsubmit.co/ajax/JivaSteps@gmail.com", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                if(statusDiv) statusDiv.innerHTML = "<p style='color:green'>✅ Invite sent successfully!</p>";
                form.reset();
            })
            .catch(error => {
                console.log(error);
                if(statusDiv) statusDiv.innerHTML = "<p style='color:red'>❌ Something went wrong.</p>";
            })
            .finally(() => {
                btn.innerHTML = "Send Invite";
                btn.disabled = false;
            });
            console.log("Form submitted!"); // Test log
        });

    } else {
        // Optional: Log this to know the script skipped this page
        console.log("Invite form not found on this page - skipping script.");
    }
});
</script>
    <script src="script.js"></script>
</body>

</html>